<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>How to bind Kendo TreeView for PHP to remote service which returns JSON</title>
        <link rel="shortcut icon" href="/kendo-ui/favicon.ico"/>
        <meta name="description" content="Learn how to bind Kendo UI TreeView for PHP to JSON">
        <link href="http://cdn.kendostatic.com/2014.1.528/styles/kendo.common.min.css" rel="stylesheet" />
        <link href="/kendo-ui/assets/css/styles.css" rel="stylesheet" />
        <link href="/kendo-ui/assets/css/theme.css" rel="stylesheet" />
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.1.528/js/kendo.web.min.js"></script>
        <script src="/kendo-ui/assets/js/prettify.js"></script>
        <script src="/kendo-ui/assets/js/app.js"></script>
        
    </head>
    <body>
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
            <div id="logo-bar">
    <a href="/kendo-ui/">
        <img alt="Kendo UI logo" class="logo" src="/kendo-ui/assets/images/logo.png">
    </a>
</div>
<div class="nav-buttons">
    <a href="http://demos.telerik.com/kendo-ui/" class="btn">Demos</a>
    <a href="http://www.telerik.com/kendo-ui/" class="btn">About</a>
    <a href="http://www.telerik.com/purchase/kendo-ui" class="btn">Pricing</a>
    <a href="http://www.telerik.com/download/kendo-ui" class="btn btn-primary">Try now</a>
</div>

        </header>

        <div id="page-top">
    <ul id="page-tabs">
        <li><a href="/kendo-ui/">Home</a></li>
        
        <li><a href="/kendo-ui/api/introduction">API Reference</a></li>
        
        
        <li class="active">Getting Started</li>
        
        
        <li><a href="/kendo-ui/howto/add-charts-and-graphs-to-an-application">How Do I?</a></li>
        
        
        <li><a href="/kendo-ui/tutorials/inheritance-with-kendoui">Tutorials</a></li>
        
    </ul>
    <div id="page-search">
        <script>
  (function() {
    var cx = '001595215763381649090:eblhnfskwrk';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

    </div>
</div>
<div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
        $("#page-tree").kendoTreeView({
            dataSource: {
                transport: {
                    read: {
                        url: "/kendo-ui/getting-started.json",
                        dataType: "json"
                    }
                },
                schema: {
                    model: {
                        id: "path",
                        children: "items",
                        hasChildren: "items"
                    }
                }
            },
            select: preventParentSelection,
            template: navigationTemplate("/kendo-ui/"),
            dataBound: expandNavigation("getting-started/using-kendo-with/php/widgets/treeview/remote-binding.html")
        });
        </script>
    </div>

    

    <div id="page-article">
        <article>
            <h1 id="remote-binding">Remote Binding</h1>

<p>This help topic shows how to bind Kendo TreeView for PHP to JSON response. Remote binding means that only the nodes that the user has expanded will be sent to the client, loaded on demand.</p>

<blockquote>
  <p>The following demos are using the sample SQLite database shipped with the Telerik UI for PHP** demos (**/wrappers/php/sample.db).</p>
</blockquote>

<h2 id="binding-to-array-returned-by-pdo">Binding to array returned by PDO</h2>

<h3 id="configure-treeview-for-remote-binding">Configure TreeView for Remote Binding</h3>

<ol>
  <li>
    <p>Follow the steps from the <a href="/getting-started/using-kendo-with/php/introduction">introduction</a> - include the autoloader, JavaScript and CSS files.</p>
  </li>
  <li>
    <p>Create a data source and configure it:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> &lt;?php
 $transport = new \Kendo\Data\DataSourceTransport();

 $read = new \Kendo\Data\DataSourceTransportRead();

 $read-&gt;url('employees.php')
      -&gt;contentType('application/json')
      -&gt;type('POST');

 $transport-&gt;read($read)
           -&gt;parameterMap('function(data) {
               return kendo.stringify(data);
           }');

 $model = new \Kendo\Data\HierarchicalDataSourceSchemaModel();

 $model-&gt;id("EmployeeID")
       -&gt;hasChildren("HasEmployees");

 $schema = new \Kendo\Data\HierarchicalDataSourceSchema();
 $schema-&gt;model($model);

 $dataSource = new \Kendo\Data\HierarchicalDataSource();

 $dataSource-&gt;transport($transport)
            -&gt;schema($schema);
 ?&gt;
</code></pre></div>    </div>
  </li>
  <li>
    <p>Create a treeview, configure its columns and set its data source.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> &lt;?php
 $treeview = new \Kendo\UI\TreeView('treeview');

 $treeview-&gt;dataSource($dataSource)
          -&gt;dataTextField("FirstName");
 ?&gt;
</code></pre></div>    </div>
  </li>
  <li>
    <p>Output the treeview by echo-ing the result of the render method.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> &lt;?php
 echo $treeview-&gt;render();
 ?&gt;
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="create-php-file-which-returns-json">Create PHP file which returns JSON</h3>

<ol>
  <li>Create a new php file called <strong>employees.php</strong>. This file will return data in JSON format. The data source is configured to request it via the <a href="/api/wrappers/php/Kendo/Data/DataSourceTransportRead#url">url</a> setting.</li>
  <li>
    <p>Create a PDO connection</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> &lt;?php
 $db = new PDO('sqlite:../sample.db');
 ?&gt;
</code></pre></div>    </div>
  </li>
  <li>
    <p>Retrieve all records from the <code class="language-plaintext highlighter-rouge">Employees</code> table, children of the sent EmployeeID. If the paramater is not set, retrieve only the root nodes.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> &lt;?php
 $request = json_decode(file_get_contents('php://input'), true);

 if (isset($request['EmployeeID'])) {
     $employeeId = $request['EmployeeID'];
 } else {
     $employeeId = null;
 }

 $sql = 'SELECT m.EmployeeID, m.FirstName, m.LastName, '
     . '(SELECT COUNT(*) FROM Employees x WHERE x.ReportsTo=m.EmployeeID) as HasEmployees '
     . 'FROM Employees m '
     . 'WHERE ReportsTo is ?';

 $statement = $db-&gt;prepare($sql);

 $statement-&gt;execute(array($employeeId));

 $data = $statement-&gt;fetchAll(PDO::FETCH_ASSOC);
 ?&gt;
</code></pre></div>    </div>
  </li>
  <li>
    <p>Post-process the data, if necessary. In this case, the <code class="language-plaintext highlighter-rouge">HasEmployees</code> field needs to be boolean.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> &lt;?php
 $employees = array();

 foreach ($data as $employee) {
     $employee["HasEmployees"] = $employee["HasEmployees"] != 0;
     $employees[] = $employee;
 }
 ?&gt;
</code></pre></div>    </div>
  </li>
  <li>
    <p>Return the records as JSON</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> &lt;?php
 // Set response content type
 header('Content-Type: application/json');

 // Return JSON
 echo json_encode($employees);
 ?&gt;
</code></pre></div>    </div>
  </li>
</ol>


        </article>
    </div>
</div>

<footer>
    <p>Copyright &copy; 2002-2014 Telerik Inc</p>
</footer>


    </body>
</html>

