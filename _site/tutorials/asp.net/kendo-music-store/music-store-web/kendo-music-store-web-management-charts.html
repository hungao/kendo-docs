<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title></title>
        <link rel="shortcut icon" href="/favicon.ico"/>
        
        <link href="/assets/css/kendo.common.min.css" rel="stylesheet" />
        <link href="/assets/css/styles.css" rel="stylesheet" />
        <link href="/assets/css/theme.css" rel="stylesheet" />
        <script src="/assets/jquery-1.10.2.js"></script>
        <script src="/assets/kendo.web.min.js"></script>
        <script src="/assets/js/prettify.js"></script>
        <script src="/assets/js/app.js"></script>
        
    </head>
    <body>

        <header id="page-header">
            <div id="logo-bar">
    <a href="/">
        <img alt="Kendo UI logo" class="logo" src="/assets/images/logo.png">
    </a>
</div>

        </header>

        <div id="page-top">
    <ul id="page-tabs">
        <li><a href="/">Home</a></li>
        
        <li><a href="/api/introduction">API Reference</a></li>
        
        
        <li><a href="/getting-started/introduction">Getting Started</a></li>
        
        
        <li><a href="/howto/add-charts-and-graphs-to-an-application">How Do I?</a></li>
        
        
        <li class="active">Tutorials</li>
        
    </ul>
    <div id="page-search">
          
    </div>
</div>
<div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
        $("#page-tree").kendoTreeView({
            dataSource: {
                transport: {
                    read: {
                        url: "/tutorials.json",
                        dataType: "json"
                    }
                },
                schema: {
                    model: {
                        id: "path",
                        children: "items",
                        hasChildren: "items"
                    }
                }
            },
            select: preventParentSelection,
            template: navigationTemplate("/"),
            dataBound: expandNavigation("tutorials/asp.net/kendo-music-store/music-store-web/kendo-music-store-web-management-charts.html")
        });
        </script>
    </div>

    

    <div id="page-article">
        <article>
            <h1 id="creating-the-store-management-charts---kendo-music-store">Creating the Store Management Charts - Kendo Music Store</h1>

<p><img src="/tutorials/asp.net/kendo-music-store/music-store-web/images/kendo-manage-charts-screenshot.png" alt="kendo-manage-charts-screenshot" /></p>

<p>When logged in to the Music Store as an administrator an additional button titled "Manage Store" is made available in the upper right corner.
This opens the management graphs which can be used to monitor the sales status of the store.
This page uses <a href="http://demos.telerik.com/kendo-ui/dataviz/overview/index.html">Kendo DataViz</a> to render the graphs.</p>

<p>This code is located in <strong>Scripts/App/storemanager-graphs.js</strong>.</p>

<blockquote>
  <p>You can log in to the Music Store as the administrator by using the username "Owner" and the password "p@ssword123".</p>
</blockquote>

<h2 id="setting-up-the-html">Setting up the HTML</h2>

<p>The page contains a date range selector that can be used to choose whether to view a day, week, month, or year of data.
This selector is represented by a <a href="http://demos.telerik.com/kendo-ui/web/listview/index.html">Kendo ListView</a> widget.
The main graph is represented by a <a href="http://demos.telerik.com/kendo-ui/dataviz/overview/index.html">Kendo DataViz Chart</a>.
The HTML used is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;ul id="date-range" class="selector" &gt;&lt;/ul&gt;
&lt;h3&gt;Overall Sales&lt;/h3&gt;
&lt;div id="revenue-chart"&gt;&lt;/div&gt;
</code></pre></div></div>

<h2 id="initializing-the-widgets">Initializing the Widgets</h2>

<p>We start by setting up the DataSource for the Revenue/Orders chart:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var revenueChartDataSource = new kendo.data.DataSource({
    transport: {
        read: {
            url: store.config.salesAndRevenueUrl,
            dataType: "json"
        }
    },
    sort: {
        field: "Day",
        dir: "asc"
    }
});
</code></pre></div></div>

<blockquote>
  <p>Please note that the data represented by these charts is generated randomly on the server.
It was unreasonable to backfill a year"s worth of orders into the SQL Local DB on startup.</p>
</blockquote>

<p>Then the grid is initialized with this data:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var createOrderRevenueChart = function () {
    $("#revenue-chart").kendoChart({
        theme: $(document).data("kendoSkin") || "default",
        dataSource: revenueChartDataSource,
        legend: {
            position: "top"
        },
        series: [
            ...
        ],
        valueAxis: [
            ...
        ],
        categoryAxis: {
            ...
        },
        tooltip: {
            visible: true
        }
    });
};
</code></pre></div></div>

<h3 id="specify-series">Specify Series</h3>

<p>The chart contains 2 series. One is the total revenue per day. The other is the number of orders per day.
There are defined in the <strong>series: []</strong> array property.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        series: [
            {
                type: "column",
                name: "Revenue",
                field: "Revenue",
                color: "#cc6e38",
                tooltip: {
                    visible: true,
                    format: "{0:c}"
                }
            },
            {
                type: "line",
                name: "Orders",
                field: "Orders",
                color: "#5a5959",
                axis: "orders",
                tooltip: {
                    visible: true,
                    format: "{0} Orders"
                }
            }
        ]
</code></pre></div></div>

<p>Each series is defined by an object that contains these properties:</p>

<p><strong>type</strong> is the type or style of chart to render. Here we use a column chart for the revenue and a line chart for the orders.
This demonstrates that we can mix chart types on a single chart.</p>

<p><strong>name</strong> is the display name that will be put in the legend of the chart, if the legend is displayed.</p>

<p><strong>field</strong> is the name of the property on the data that contains the values we want to render on the chart.</p>

<p><strong>color</strong> is the color used to represent the series on the chart and in the legend.</p>

<p><strong>tooltip</strong> defines what will be displayed if the user mouses over a data point or column.
The format string follows the parameters for the <a href="http:///api/framework/kendo#format">kendo.format</a> function.</p>

<h3 id="specify-the-axis">Specify the Axis</h3>

<p>The <strong>valueAxis</strong> property is set to an array of objects that represent the vertical axis on the chart.
The number of items in the series and valueAxis arrays should be the same.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        valueAxis: [
            {
                title: { text: "Revenue" },
                labels: {
                    format: "c"
                }
            },
            {
                name: "orders",
                title: { text: "Number of Orders" },
                color: "#ec5e0a"
            }
        ]
</code></pre></div></div>

<p><strong>name</strong> is the display value that will be placed along side the vertical axis.</p>

<p>The <strong>categoryAxis</strong> property is set to a single item that represents the horizontal axis.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        categoryAxis: {
            field: "Day",
            format: "d",
            type: "date",
            baseUnit: selectedDateRange.unit,
            labels: {
                rotation: 60
            },
            axisCrossingValue: [0, 1000]
        }
</code></pre></div></div>

<p><strong>field</strong> is the name of the property on the data objects that will be used to get the value to display.</p>

<p><strong>format</strong> and <strong>type</strong> are used to specify the axis consists of dates and to format them as dates.</p>

<p><strong>labels.rotation</strong></p>

<p>The <strong>axisCrossingValue</strong> is an array that specified where each of the vertical axis defined in the valueAxis array should be rendered.
Each value in the array corresponds to the valueAxis with the same array index.
We specify 0 for the first value to place the "Revenue" vertical axis on the left.
To place the "Orders" vertical axis on the right side of the graph, a number has to be chosen that is better than the number of items
in the categoryAxis. Here our biggest collection will be when we display data for the "Month" time range, where we show the last 30 days,
so any number higher than that could have been chosen.</p>

<h2 id="changing-the-date-ranges">Changing the Date Ranges</h2>

<p>To facilitate selecting a date range to display on the chart, we used a Kendo ListView widget to display the available date ranges.
First we defined an array of the date ranges, using <strong>date.js</strong> to get ranges appropriate date ranges.
The default selected item is also saved to a separate variable.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var dateRanges = [{
    name: "Day",
    start: Date.today().toString("M/d/yyyy"),
    end: Date.today().add(1).days().toString("M/d/yyyy"),
    unit: "days"
},
{
    name: "Week",
    start: Date.today().add(-7).days().toString("M/d/yyyy"),
    end: Date.today().add(1).days().toString("M/d/yyyy"),
    unit: "days"
},
{
    name: "Month",
    start: Date.today().add(-1).months().toString("M/d/yyyy"),
    end: Date.today().add(1).days().toString("M/d/yyyy"),
    unit: "days"
},
{
    name: "Year",
    start: Date.today().add(-1).years().toString("M/d/yyyy"),
    end: Date.today().add(1).days().toString("M/d/yyyy"),
    unit: "months"
}];

var selectedDateRange = dateRanges[1];
</code></pre></div></div>

<p>When we query the server for data, we want to add the start and end date of the selected date range as query string parameters.
To do this, we override the <strong>transport.parameterMap</strong> on the DataSource, referencing the <strong>selectedDateRange</strong> in a closure.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var revenueChartDataSource = new kendo.data.DataSource({
    transport: {
        ...
 
        parameterMap: function (options, type) {
            return {
                start: selectedDateRange.start,
                end: selectedDateRange.end
            };
        }
        
        ...
</code></pre></div></div>

<p>In the parameterMap function, we return an object that has <strong>start</strong> and <strong>end</strong> properties, which will be added to the request to the server.</p>

<p>The HTML element to hold the date range selector also needs to be set to a ListView widget, and the currently selected value set to the default date range:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var dateRangeSelector = $("#date-range");
dateRangeSelector.kendoListView({
    dataSource: dateRanges,
    template: "&lt;li&gt;#= name #&lt;/li&gt;",
    selectable: "single",
    change: dateRangeChanged
});
dateRangeSelector.data("kendoListView").select(dateRangeSelector.children()[1]);
</code></pre></div></div>

<p>The ListView has <strong>selectable: "single"</strong> defined in its configuration, which puts the ListView into a selection mode where one item can be selected at a time.
On selection change, the <strong>change</strong> event is triggered. This calls the <strong>dateRangeChanged</strong> function:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var dateRangeChanged = function (e) {
    var data = this.dataSource.view();
    selectedDateRange = data[$(this.select()[0]).index()];
    $("#revenue-chart").data("kendoChart").options.categoryAxis.baseUnit = selectedDateRange.unit;
    revenueChartDataSource.read();
    genreChartDataSource.read();
};
</code></pre></div></div>

<p>In this function, we take the selected date range item and update the <strong>selectedDateRange</strong> variable.
Then the chart data is redrawn by updating its underlying data source, by calling its <strong>.read()</strong> method.
The <strong>baseUnit</strong> for the chart is also changed based on the date range.
For Day, Week and Month, the scale is set to a single day.
For Year, the scale is set to one month.
This is done by setting the <strong>options.categoryAxis.baseUnit</strong> property on the chart before it is redrawn.</p>

        </article>
    </div>
</div>

<footer>
    <p>Copyright &copy; 2002-2014 Telerik Inc</p>
</footer>


    </body>
</html>

